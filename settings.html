<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªÙˆØµÙŠÙ„Ùˆ PRO | Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #6B2E82; --secondary: #FF6B35; --dark: #1a1a1a; }
        body { font-family: 'Cairo', sans-serif; background: #f4f7f6; margin: 0; display: flex; }
        .sidebar { width: 260px; background: var(--dark); height: 100vh; position: fixed; padding: 20px; color: white; }
        .main-content { margin-right: 260px; width: calc(100% - 260px); padding: 40px; }
        
        .settings-card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); max-width: 800px; }
        .setting-group { margin-bottom: 25px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        .setting-group:last-child { border: none; }
        
        label { display: block; font-weight: 800; margin-bottom: 10px; color: var(--dark); }
        input, select { width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 12px; font-family: 'Cairo'; font-size: 16px; transition: 0.3s; }
        input:focus { border-color: var(--primary); outline: none; }
        
        .btn-save { background: var(--primary); color: white; border: none; padding: 15px 40px; border-radius: 12px; cursor: pointer; font-weight: 800; font-size: 16px; width: 100%; transition: 0.3s; }
        .btn-save:hover { background: #562469; transform: translateY(-2px); }
        
        .hint { font-size: 12px; color: #888; margin-top: 5px; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2 style="color: var(--secondary); text-align: center;">ØªÙˆØµÙŠÙ„Ùˆ ğŸ›µ</h2>

        <a href="index.html" class="nav-item active"><i class="fas fa-chart-line"></i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</a>
        <a href="users_admin.html" class="nav-item"><i class="fas fa-user-friends"></i> Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§Ø·Ù†ÙŠÙ†</a>
        <a href="drivers_admin.html" class="nav-item"><i class="fas fa-id-card"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</a>
        <a href="users.html" class="nav-item"><i class="fas fa-users-cog"></i> Ø§Ù„ÙƒÙ„ (Ø³Ø§Ø¦Ù‚ÙŠÙ† ÙˆÙ…ÙˆØ§Ø·Ù†ÙŠÙ†)</a>
        <a href="requests.html" class="nav-item"><i class="fas fa-user-plus"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„</a>
        <a href="trips.html" class="nav-item"><i class="fas fa-route"></i> Ø³Ø¬Ù„ Ø§Ù„Ø±Ø­Ù„Ø§Øª</a>
        <a href="audit.html" class="nav-item"><i class="fas fa-file-invoice-dollar"></i> Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø§Ù„ÙŠ</a>
                        <a href="report.html" class="nav-item"><i class="fas fa-route"></i> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± </a>
        <a href="complaints.html" class="nav-item"><i class="fas fa-exclamation-triangle"></i> Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</a>

    </div>

    <div class="main-content">
        <h1>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© âš™ï¸</h1>
        
        <div class="settings-card">
            <div class="setting-group">
                <label>Ù†Ø³Ø¨Ø© Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (%)</label>
                <input type="number" id="app_commission" placeholder="Ù…Ø«Ù„Ø§Ù‹: 15">
                <p class="hint">Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø¨Ø© ØªÙØ®ØµÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† ÙƒÙ„ Ø±Ø­Ù„Ø© ÙˆØªÙØ¶Ø§Ù Ù„Ø¯ÙŠÙˆÙ† Ø§Ù„Ø³Ø§Ø¦Ù‚.</p>
            </div>

            <div class="setting-group">
                <label>Ø­Ø¯ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø§Ù„Ø£Ù‚ØµÙ‰ (Ø±.Ø³)</label>
                <input type="number" id="debt_limit" placeholder="Ù…Ø«Ù„Ø§Ù‹: 200">
                <p class="hint">Ø¹Ù†Ø¯Ù…Ø§ ÙŠØµÙ„ Ø¯ÙŠÙ† Ø§Ù„Ø³Ø§Ø¦Ù‚ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„ØºØŒ Ø³ÙŠØªÙ… Ø¥ÙŠÙ‚Ø§ÙÙ‡ Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­ØªÙ‰ ÙŠØ³Ø¯Ø¯.</p>
            </div>

            <div class="setting-group">
                <label>Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ø©</label>
                <select id="system_status">
                    <option value="active">Ù†Ø´Ø· (Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨Ø§Øª)</option>
                    <option value="maintenance">ØµÙŠØ§Ù†Ø© (Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ø¤Ù‚ØªØ§Ù‹)</option>
                </select>
            </div>

            <button class="btn-save" onclick="saveSettings()">Ø­ÙØ¸ ÙƒØ§ÙØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª âœ¨</button>
        </div>
    </div>

    <script>
        async function loadSettings() {
            const { data } = await _supabase.from('settings').select('*');
            if (data) {
                data.forEach(s => {
                    const el = document.getElementById(s.setting_key);
                    if (el) el.value = s.setting_value;
                });
            }
        }

        async function saveSettings() {
            const settings = [
                { setting_key: 'app_commission', setting_value: document.getElementById('app_commission').value },
                { setting_key: 'debt_limit', setting_value: document.getElementById('debt_limit').value },
                { setting_key: 'system_status', setting_value: document.getElementById('system_status').value }
            ];

            const { error } = await _supabase.from('settings').upsert(settings);

            if (!error) {
                alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† Ø¨Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©!");
            } else {
                alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸: " + error.message);
            }
        }

        window.onload = loadSettings;
    </script>
</body>
</html>
