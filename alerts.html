<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</title>
<link rel="stylesheet" href="style.css">

<style>
body {
  background:#eef2f7;
  font-family:'Cairo', sans-serif;
  padding:20px;
  margin:0;
}

.nav {
  background:white;
  padding:12px;
  border-radius:14px;
  box-shadow:0 3px 10px rgba(0,0,0,0.1);
  display:flex;
  justify-content:space-around;
  font-size:15px;
  margin-bottom:20px;
}

.section {
  margin-top:10px;
}

h2 {
  text-align:center;
  margin-bottom:20px;
}

.item {
  background:white;
  padding:18px;
  border-radius:14px;
  box-shadow:0 3px 10px rgba(0,0,0,0.1);
  margin-bottom:15px;
}

.item h3 {
  margin:0 0 8px 0;
  font-size:20px;
}

.item p {
  margin:6px 0;
}
</style>
</head>

<body>

<div class="nav">
  <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a href="alerts.html">Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</a>
  <a href="reasons.html">Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨</a>
  <a href="schedule.html">Ø§Ù„Ø¬Ø¯ÙˆÙ„</a>
  <a href="reports.html">Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</a>
</div>

<div class="section">
  <h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</h2>
  <div id="list">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
</div>

<script type="module">
import { db } from "./firebase.js";
import { collection, getDocs } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

function formatDate(ts) {
  if (!ts) return "â€”";
  const date = ts.toDate();
  return date.toLocaleString("ar-EG", {
    year: "numeric",
    month: "long",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit"
  });
}

async function loadAlerts() {
  const list = document.getElementById("list");
  list.innerHTML = "<p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>";

  try {
    const snap = await getDocs(collection(db, "alerts"));

    let html = "";
    snap.forEach(doc => {
      const a = doc.data();

      html += `
        <div class="item" style="background:#ff5252;color:white;">
          <h3>${a.title}</h3>
          <p>${a.text}</p>

          <hr style="border:0;border-top:1px solid #fff4; margin:10px 0;">

          <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> 
            ${a.active ? "ğŸ”µ Ù†Ø´Ø·" : "âš« ØºÙŠØ± Ù†Ø´Ø·"}
          </p>

          <p><strong>ÙˆÙ‚Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©:</strong> 
            ${formatDate(a["ÙˆÙ‚Øª Ø§Ù„Ø§Ø¶Ø§ÙÙ‡"])}
          </p>
        </div>
      `;
    });

    list.innerHTML = html || "<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</p>";

  } catch (err) {
    list.innerHTML = "<p>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>";
    console.error(err);
  }
}

loadAlerts();
</script>

</body>
</html>
